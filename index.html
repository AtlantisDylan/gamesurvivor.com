<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />

  <title>èåœçº¸å·¾çŒ«æƒ…ä¾£ç‰ˆï½œä½†ç”·å‹æ˜¯é‚£åªçŒ« - GameSurvivors</title>
  <meta name="description" content="èåœçº¸å·¾çŒ«æƒ…ä¾£ç‰ˆï¼Œä½†ç”·å‹æ˜¯é‚£åªçŒ«ã€‚åˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³ï¼š3æ¬¡æœºä¼šï¼Œé€‰å¯¹äº²äº²ğŸ’‹ï¼Œé€‰é”™æ¦´è²ğŸˆï¼Œçœ‹çœ‹ç”·å‹çš„é»˜å¥‘åº¦ã€‚" />
  <meta name="robots" content="index,follow,max-image-preview:large" />
  <link rel="canonical" href="https://gamesurvivors.com/luobo-zhijin-couple" />
  <meta name="theme-color" content="#FF9F0A" />

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            appleCard: "#FFFFFF",
            appleText: "#1D1D1F",
            appleSub: "#6E6E73",
            appleBlue: "#0A84FF",
            appleGreen: "#34C759",
            appleRed: "#FF3B30",
            appleGray: "#E5E5EA",
            warmA: "#FFF3E8",
            warmB: "#FFD8B5",
            warmC: "#FFB26B",
            warmD: "#FF8A00"
          },
          boxShadow: {
            apple: "0 10px 30px rgba(0,0,0,0.10)"
          }
        }
      }
    }
  </script>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"èåœçº¸å·¾çŒ«æƒ…ä¾£ç‰ˆï½œä½†ç”·å‹æ˜¯é‚£åªçŒ«",
    "url":"https://gamesurvivors.com/luobo-zhijin-couple",
    "applicationCategory":"GameApplication",
    "operatingSystem":"Web",
    "description":"èåœçº¸å·¾çŒ«æƒ…ä¾£ç‰ˆï¼šç”·å‹ä¸‰è¿è¾¨å¦†æŒ‘æˆ˜ã€‚æ™®é€š=åªçœ‹æ–‡å­—ï¼›å›°éš¾=åªçœ‹å›¾ã€‚ç­”å¯¹äº²å»å¥–åŠ±ï¼Œç­”é”™æ¦´è²æƒ©ç½šï¼Œçº¢å¿ƒç»“ç®—é»˜å¥‘å€¼ã€‚"
  }
  </script>

  <style>
    .tap-scale { transform: translateZ(0); }
    .tap-scale:active { transform: scale(0.98); }
    .safe-pb { padding-bottom: env(safe-area-inset-bottom); }
    .no-select { -webkit-user-select:none; user-select:none; }

    /* æ›´â€œåƒäººåšçš„â€ï¼šè½»å¾®ç»ç’ƒè´¨æ„Ÿ */
    .glass {
      background: rgba(255,255,255,0.86);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* æ¸©é¦¨ä½†æœ‰æ´»åŠ›çš„æ©˜è‰²èƒŒæ™¯ */
    body{
      background:
        radial-gradient(900px 520px at 12% 10%, #FFF3E8 0%, rgba(255,243,232,0.0) 60%),
        radial-gradient(900px 520px at 88% 12%, #FFD8B5 0%, rgba(255,216,181,0.0) 60%),
        linear-gradient(180deg, #FFB26B 0%, #FF8A00 100%);
    }

    /* Emoji å¢™çº¸å±‚ */
    #emojiWall span{
      position:absolute;
      user-select: none;
      -webkit-user-select:none;
      pointer-events:none;
      mix-blend-mode: soft-light;
      text-shadow: 0 10px 30px rgba(0,0,0,0.10);
      filter: blur(0.2px);
      will-change: transform;
    }

    @media (prefers-reduced-motion: reduce){
      #emojiWall span{ transition:none!important; animation:none!important; }
    }
  </style>
</head>

<body class="text-appleText safe-pb">
  <!-- Emoji wallpaper layer -->
  <div id="emojiWall" class="fixed inset-0 overflow-hidden -z-10" aria-hidden="true"></div>

  <header class="max-w-3xl mx-auto px-4 sm:px-6 pt-10 pb-6 relative z-10">
    <!-- ä»… 1 ä¸ª H1 -->
    <h1 class="text-2xl sm:text-4xl font-semibold tracking-tight">
      èåœçº¸å·¾çŒ«æƒ…ä¾£ç‰ˆï¼Œä½†ç”·å‹æ˜¯é‚£åªçŒ«
    </h1>
    <p class="mt-3 text-appleSub leading-relaxed max-w-2xl">
      åˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³ã€‚
    </p>
  </header>

  <main class="max-w-3xl mx-auto px-4 sm:px-6 pb-12 relative z-10">
    <!-- ========== A) åˆå§‹é¡µé¢ ========== -->
    <section id="viewHome" class="rounded-2xl glass shadow-apple border border-white/60 p-5 sm:p-6">
      <h2 class="text-lg sm:text-xl font-semibold">å¼€å±€å‰å…ˆå®šè°ƒ</h2>
      <p class="mt-2 text-appleSub leading-relaxed">
        ä¸€å…±ä¸‰å…³ï¼šé€‰å¯¹äº²äº²ğŸ’‹ï¼Œé€‰é”™æ¦´è²ğŸˆï¼Œæœ€åçœ‹ä½ èƒ½æ‹¿å‡ é¢—å¿ƒâ¤ï¸ã€‚
      </p>

      <!-- éš¾åº¦é€‰æ‹© -->
      <div class="mt-4 rounded-xl border border-appleGray/60 bg-white/75 p-4">
        <div class="text-sm text-appleSub">é€‰æ‹©éš¾åº¦</div>
        <div class="mt-2 inline-flex rounded-xl border border-appleGray/60 overflow-hidden">
          <button id="btnDiffEasy" class="px-4 py-2 text-sm font-medium bg-white hover:bg-warmA transition">
            æ™®é€šæ¨¡å¼
          </button>
          <button id="btnDiffHard" class="px-4 py-2 text-sm font-medium bg-warmA hover:bg-warmA transition">
            å›°éš¾æ¨¡å¼
          </button>
        </div>
        <div id="diffHint" class="mt-2 text-sm text-appleSub">
          å›°éš¾ï¼šçœ‹å›¾ä½œç­”ã€‚åˆ«é—®ï¼Œé—®å°±æ˜¯â€œä½ å…ˆè¯•è¯•â€ã€‚
        </div>
      </div>

      <div class="mt-5 grid grid-cols-1 sm:grid-cols-3 gap-3">
        <button id="btnGoGame" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-3 bg-appleBlue text-white font-medium shadow-apple hover:opacity-95 transition">
          å¼€å§‹æ¸¸æˆ
        </button>

        <button id="btnGoRules" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-3 bg-white/85 border border-appleGray/60 text-appleText font-medium hover:shadow-apple transition">
          æŸ¥çœ‹ç»†è‡´è§„åˆ™
        </button>

        <button id="btnGoScore" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-3 bg-white/85 border border-appleGray/60 text-appleText font-medium hover:shadow-apple transition">
          æœ€è¿‘ç§¯åˆ†
        </button>
      </div>

      <div class="mt-6 rounded-xl border border-appleGray/60 bg-white/75 p-4">
        <div class="text-sm text-appleSub">å‹æƒ…æç¤º</div>
        <div class="mt-1 font-medium">
          è¿™ä¸æ˜¯åŒ–å¦†è€ƒè¯•ï¼Œè¿™æ˜¯æƒ…ä¾£é»˜å¥‘æµ‹è¯•ã€‚ç­”é”™ä¹Ÿåˆ«æ€¥ï¼Œä¸‹æ¬¡åŠªåŠ›ã€‚
        </div>
      </div>
    </section>

    <!-- ========== æŸ¥çœ‹ç»†è‡´è§„åˆ™ï¼ˆå•ç‹¬é¡µï¼‰ ========== -->
    <section id="viewRules" class="hidden mt-6 rounded-2xl glass shadow-apple border border-white/60 p-5 sm:p-6">
      <div class="flex items-start justify-between gap-3">
        <h2 class="text-lg sm:text-xl font-semibold">ç»†è‡´è§„åˆ™</h2>
        <button id="btnRulesBack" class="tap-scale rounded-xl px-3 py-2 bg-white/85 border border-appleGray/60 text-sm font-medium hover:shadow-apple transition">
          è¿”å›
        </button>
      </div>

      <ul class="mt-4 space-y-2 text-appleSub leading-relaxed">
        <li>ä½ æ‰®æ¼”ç”·å‹ï¼šæ¯é¢˜ä»ä¸¤ä¸ªâ€œçœ‹èµ·æ¥å¾ˆåƒ/åå­—å¾ˆåƒâ€çš„åŒ–å¦†å“é‡ŒäºŒé€‰ä¸€ã€‚</li>
        <li>æ¯å±€å…± 3 é¢˜ï¼›åŒä¸€å±€å†…é¢˜ç›®ä¸é‡å¤ã€‚</li>
        <li><strong>æ™®é€šæ¨¡å¼</strong>ï¼šé€‰é¡¹åªç»™åå­—ï¼›æ›´é€‚åˆçƒ­èº«ã€‚</li>
        <li><strong>å›°éš¾æ¨¡å¼</strong>ï¼šé€‰é¡¹åªç»™å›¾ç‰‡ï¼›ä½ å¾—æ—¢æ‡‚ç”¨é€”ï¼Œä¹Ÿè®¤å¾—é•¿ç›¸ã€‚</li>
        <li>ä½œç­”åç«‹åˆ»å…¬å¸ƒç»“æœï¼šç­”å¯¹ğŸ’‹ï¼Œç­”é”™ğŸˆï¼Œå¹¶ç»™å‡ºé¢˜ç›®è§£æï¼ˆè®©ä½ ä¸‹æ¬¡å°‘æŒ¨éª‚ï¼‰ã€‚</li>
        <li>ç»“ç®—ï¼šç”¨ 1-3 é¢—çº¢å¿ƒâ¤ï¸ä»£è¡¨ç­”å¯¹é¢˜æ•°ï¼ˆ0é¢˜æ˜¾ç¤ºğŸ’”ï¼‰ã€‚</li>
      </ul>
    </section>

    <!-- ========== æœ€è¿‘ç§¯åˆ†ï¼ˆå•ç‹¬é¡µï¼‰ ========== -->
    <section id="viewScore" class="hidden mt-6 rounded-2xl glass shadow-apple border border-white/60 p-5 sm:p-6">
      <div class="flex items-start justify-between gap-3">
        <h2 class="text-lg sm:text-xl font-semibold">æœ€è¿‘ç§¯åˆ†</h2>
        <button id="btnScoreBack" class="tap-scale rounded-xl px-3 py-2 bg-white/85 border border-appleGray/60 text-sm font-medium hover:shadow-apple transition">
          è¿”å›
        </button>
      </div>

      <p class="mt-3 text-appleSub leading-relaxed">
        æœ¬åœ°è®°å½•æœ€è¿‘ 5 å±€ï¼ˆä»…ä¿å­˜åœ¨ä½ çš„æµè§ˆå™¨ä¸­ï¼‰ã€‚
      </p>

      <div class="mt-4 rounded-xl border border-appleGray/60 bg-white/75 p-4">
        <div class="flex items-center justify-between gap-3">
          <div class="text-sm text-appleSub">è®°å½•åˆ—è¡¨</div>
          <button id="btnClearHistory" class="tap-scale rounded-xl px-3 py-2 bg-white/85 border border-appleGray/60 text-sm font-medium hover:shadow-apple transition">
            æ¸…ç©ºè®°å½•
          </button>
        </div>

        <div id="historyList" class="mt-3 space-y-3"></div>
        <div id="historyEmpty" class="mt-3 text-sm text-appleSub hidden">æš‚æ— è®°å½•ã€‚å…ˆæ¥ä¸€å±€å§ã€‚</div>
      </div>
    </section>

    <!-- ========== B) æ¸¸æˆé¡µï¼š3é“é¢˜ ========== -->
    <section id="viewGame" class="hidden mt-6 rounded-2xl glass shadow-apple border border-white/60 p-5 sm:p-6">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <h2 class="text-lg sm:text-xl font-semibold">ç”·å‹æŒ‘æˆ˜ï¼šç¬¬ <span id="roundNum">1</span> / 3 é¢˜</h2>
        <div class="flex items-center gap-2 text-sm text-appleSub">
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/85 border border-appleGray/60" title="æ­£ç¡®æ•°">â¤ï¸</span>
          <span id="scoreBadge" class="font-medium">0</span>
        </div>
      </div>

      <p id="prompt" class="mt-2 text-appleSub leading-relaxed">â€”</p>

      <div class="mt-5 grid grid-cols-1 sm:grid-cols-2 gap-4">
        <!-- Option A -->
        <button id="optA" class="tap-scale no-select text-left rounded-2xl border border-appleGray/60 bg-white/85 p-4 hover:shadow-apple transition disabled:opacity-50 disabled:cursor-not-allowed">
          <div class="text-sm text-appleSub">é€‰é¡¹ A</div>

          <!-- æ™®é€šï¼šä»…æ–‡å­—ï¼ˆä¸å‡ºç°å›¾ç‰‡ï¼‰ -->
          <div data-mode="easy" class="mt-3 hidden">
            <div id="optATitle" class="text-xl font-semibold tracking-tight">-</div>
            <div class="mt-1 text-sm text-appleSub">ç‚¹æˆ‘å°±ç®—ä½ é€‰è¿™ä¸ª</div>
          </div>

          <!-- å›°éš¾ï¼šä»…å›¾ç‰‡ï¼ˆä¸å‡ºç°åç§°ï¼‰ -->
          <div data-mode="hard" class="mt-3 hidden">
            <div class="rounded-xl border border-appleGray/60 overflow-hidden bg-white">
              <img id="imgA" src="" alt="åŒ–å¦†å“é€‰é¡¹Aï¼ˆå›¾ç‰‡ï¼‰" loading="eager" class="w-full aspect-square object-cover" />
            </div>
            <div id="srNameA" class="sr-only"></div>
          </div>
        </button>

        <!-- Option B -->
        <button id="optB" class="tap-scale no-select text-left rounded-2xl border border-appleGray/60 bg-white/85 p-4 hover:shadow-apple transition disabled:opacity-50 disabled:cursor-not-allowed">
          <div class="text-sm text-appleSub">é€‰é¡¹ B</div>

          <div data-mode="easy" class="mt-3 hidden">
            <div id="optBTitle" class="text-xl font-semibold tracking-tight">-</div>
            <div class="mt-1 text-sm text-appleSub">ç‚¹æˆ‘å°±ç®—ä½ é€‰è¿™ä¸ª</div>
          </div>

          <div data-mode="hard" class="mt-3 hidden">
            <div class="rounded-xl border border-appleGray/60 overflow-hidden bg-white">
              <img id="imgB" src="" alt="åŒ–å¦†å“é€‰é¡¹Bï¼ˆå›¾ç‰‡ï¼‰" loading="eager" class="w-full aspect-square object-cover" />
            </div>
            <div id="srNameB" class="sr-only"></div>
          </div>
        </button>
      </div>

      <!-- ä½œç­”åç«‹å³æ˜¾ç¤ºåé¦ˆ -->
      <div id="feedbackCard" class="hidden mt-5 rounded-xl border border-appleGray/60 bg-white/85 p-4">
        <div class="text-sm text-appleSub">å½“å‰åé¦ˆ</div>
        <div id="feedback" class="mt-2 text-base font-semibold">-</div>
        <div id="rewardLine" class="mt-2 text-2xl" aria-live="polite"></div>

        <div class="mt-3 flex flex-wrap gap-3">
          <button id="btnNext" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-2 bg-appleGreen text-white font-medium shadow-apple hover:opacity-95 transition disabled:opacity-50 disabled:cursor-not-allowed">
            ä¸‹ä¸€é¢˜
          </button>
          <button id="btnQuitToHome" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-2 bg-white/85 border border-appleGray/60 text-appleText font-medium hover:shadow-apple transition">
            é€€å‡ºåˆ°é¦–é¡µ
          </button>
        </div>
      </div>
    </section>

    <!-- ========== C) ç»“ç®—ç»“æœé¡µ ========== -->
    <section id="viewResult" class="hidden mt-6 rounded-2xl glass shadow-apple border border-white/60 p-5 sm:p-6">
      <h2 class="text-lg sm:text-xl font-semibold">ç»“ç®—ç»“æœ</h2>
      <p class="mt-2 text-appleSub leading-relaxed">
        ä½ æœ¬å±€ç­”å¯¹ <span id="finalScoreInline" class="font-semibold text-appleText">0</span> é¢˜ã€‚çº¢å¿ƒå°±æ˜¯â€œä»Šæ™šèƒ½ä¸èƒ½æ´»â€çš„æŒ‡æ ‡ã€‚
      </p>

      <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="rounded-2xl border border-appleGray/60 bg-white/85 p-5">
          <div class="text-sm text-appleSub">çº¢å¿ƒ</div>
          <div id="hearts" class="mt-2 text-3xl" aria-live="polite">â€”</div>
        </div>
        <div class="rounded-2xl border border-appleGray/60 bg-white/85 p-5">
          <div class="text-sm text-appleSub">æ­£ç¡®é¢˜æ•°</div>
          <div id="finalScore" class="mt-2 text-2xl font-semibold">â€”</div>
        </div>
        <div class="rounded-2xl border border-appleGray/60 bg-white/85 p-5">
          <div class="text-sm text-appleSub">è¯„ä»·</div>
          <div id="finalComment" class="mt-2 text-base font-semibold">â€”</div>
        </div>
      </div>

      <div class="mt-5 flex flex-wrap gap-3">
        <button id="btnPlayAgain" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-2 bg-appleBlue text-white font-medium shadow-apple hover:opacity-95 transition">
          å†æ¥ä¸€å±€
        </button>
        <button id="btnResultToHome" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-2 bg-white/85 border border-appleGray/60 text-appleText font-medium hover:shadow-apple transition">
          å›åˆ°é¦–é¡µ
        </button>
        <button id="btnResultToScore" class="tap-scale inline-flex items-center justify-center rounded-xl px-4 py-2 bg-white/85 border border-appleGray/60 text-appleText font-medium hover:shadow-apple transition">
          æŸ¥çœ‹æœ€è¿‘ç§¯åˆ†
        </button>
      </div>
    </section>

    <footer class="mt-10 text-center text-sm text-white/90">
      <h2 class="sr-only">é¡µè„š</h2>
      <p class="drop-shadow">Â© <span id="year"></span> GameSurvivors.com Â· èåœçº¸å·¾çŒ«æƒ…ä¾£ç‰ˆ</p>
    </footer>
  </main>

  <script>
    // =============================
    // Emoji wallpaperï¼šğŸ¥•ğŸ§»ğŸ±â¤ï¸ğŸ’„
    // =============================
    function renderEmojiWall() {
      const wall = document.getElementById("emojiWall");
      if (!wall) return;
      wall.innerHTML = "";

      const emojis = ["ğŸ¥•","ğŸ§»","ğŸ±","â¤ï¸","ğŸ’„"];
      const count = window.innerWidth < 640 ? 18 : 28;

      for (let i = 0; i < count; i++) {
        const sp = document.createElement("span");
        sp.textContent = emojis[Math.floor(Math.random() * emojis.length)];

        const size = (Math.random() * 26 + 18); // 18..44px
        const x = Math.random() * 100; // vw
        const y = Math.random() * 100; // vh
        const r = (Math.random() * 40 - 20); // -20..20deg
        const op = (Math.random() * 0.08 + 0.12); // 0.12..0.20

        sp.style.left = x + "vw";
        sp.style.top = y + "vh";
        sp.style.fontSize = size + "px";
        sp.style.transform = "rotate(" + r + "deg)";
        sp.style.opacity = op.toFixed(2);

        wall.appendChild(sp);
      }
    }

    // =============================
    // éš¾åº¦ï¼šæ™®é€š=æ–‡å­—ï¼Œå›°éš¾=å›¾ç‰‡
    // =============================
    const DIFF_KEY = "gs_luobo_zhijin_diff_v1"; // "easy" | "hard"
    function getDiff() {
      const v = localStorage.getItem(DIFF_KEY);
      return (v === "easy" || v === "hard") ? v : "hard";
    }
    function setDiff(v) {
      localStorage.setItem(DIFF_KEY, v);
      renderDiffUI();
    }

    // å›¾ç‰‡è·¯å¾„ï¼ˆæœ¬åœ°èµ„æºæ–¹æ¡ˆï¼‰
    const ASSET_BASE = "/assets/cosmetics/";

    // é¢˜åº“ï¼šå›°éš¾æç¤ºå£è¯­åŒ–ï¼›è§£æä¸“ä¸šåŒ–ä½†ä»…ä½œç­”åå±•ç¤º
    const PAIRS = [
      {
        id: "lipstick-vs-lipbalm",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³è¦ä¸Šå˜´æœ‰ç‚¹é¢œè‰²ã€çœ‹èµ·æ¥ç²¾ç¥ç‚¹çš„é‚£ä¸ªã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘ç°åœ¨å˜´å·´çœ‹ç€å¥½æ²¡æ°”è‰²ï¼Œä½ ç»™æˆ‘æ‹¿é‚£ä¸ªâ€œä¸Šå˜´ç«‹åˆ»åƒæ²¡ç†¬å¤œâ€çš„ã€‚ã€",
        a: { name: "æ¶¦å”‡è†", img: ASSET_BASE + "lip-balm.webp", desc: "æ¶¦å”‡è†ä»¥æ»‹æ¶¦ä¿®æŠ¤ä¸ºä¸»ï¼Œé¢œè‰²é€šå¸¸æ›´æ·¡æˆ–æ— è‰²ï¼Œæ›´åæŠ¤å”‡ç”¨é€”ã€‚" },
        b: { name: "å£çº¢", img: ASSET_BASE + "lipstick.webp", desc: "å£çº¢æ˜¾è‰²æ›´å¼ºï¼Œå¼ºè°ƒå¦†æ•ˆä¸æ°”è‰²æå‡ï¼Œé€šå¸¸æ¯”æ¶¦å”‡è†æ›´â€œæœ‰å¦†æ„Ÿâ€ã€‚" },
        correct: "å£çº¢"
      },
      {
        id: "lipgloss-vs-lipoil",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³è¦å˜´å·´äº®äº®çš„ã€åƒæœå†»é‚£æ ·çš„ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘è¦é‚£ç§ä¸€æŠ¹å°±â€œæ°´å…‰å˜Ÿå˜Ÿâ€çš„ï¼Œæ‹ç…§ä¼šåå…‰é‚£ç§ã€‚ã€",
        a: { name: "å”‡èœœï¼ˆLip Glossï¼‰", img: ASSET_BASE + "lip-gloss.webp", desc: "å”‡èœœæ›´å¼ºè°ƒé•œé¢å…‰æ³½ä¸æˆè†œå¦†æ•ˆï¼Œè§†è§‰å­˜åœ¨æ„Ÿæ›´å¼ºï¼Œå¸¸ç”¨äºæ‰“é€ â€œç»ç’ƒå”‡â€ã€‚" },
        b: { name: "å”‡æ²¹ï¼ˆLip Oilï¼‰", img: ASSET_BASE + "lip-oil.webp", desc: "å”‡æ²¹æ›´åæ»‹æ¶¦å…»æŠ¤ä¸è½»è–„å…‰æ³½ï¼Œå¦†æ•ˆé€šå¸¸æ›´åƒâ€œæŠ¤å”‡+å¾®å…‰â€ã€‚" },
        correct: "å”‡èœœï¼ˆLip Glossï¼‰"
      },
      {
        id: "foundation-vs-bb",
        promptEasy: "å¥¹è¯´ï¼šã€ä»Šå¤©è¦é®å¾—æ›´ç¨³ä¸€ç‚¹ã€å¦†çœ‹èµ·æ¥æ›´è®¤çœŸã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘ä»Šå¤©è¦è§äººï¼Œåˆ«è®©æˆ‘è„¸çœ‹èµ·æ¥â€œæ²¡ç¡é†’â€ï¼Œç»™æˆ‘æ‹¿é‚£ä¸ªæ›´èƒ½æ‰“çš„åº•ã€‚ã€",
        a: { name: "ç²‰åº•æ¶²", img: ASSET_BASE + "foundation.webp", desc: "ç²‰åº•æ¶²é®ç‘•/å¦†æ•ˆå¯é€‰èŒƒå›´æ›´å¹¿ï¼Œæ›´é€‚åˆæ‰“é€ å®Œæ•´ã€æ­£å¼çš„åº•å¦†ã€‚" },
        b: { name: "BBéœœ", img: ASSET_BASE + "bb-cream.webp", desc: "BBéœœæ›´åæ—¥å¸¸å¿«é€Ÿä¸Šè„¸ï¼Œé®ç‘•é€šå¸¸æ›´è½»è–„ï¼Œå¦†æ•ˆæ›´â€œæ‡’äººå‹å¥½â€ã€‚" },
        correct: "ç²‰åº•æ¶²"
      },
      {
        id: "concealer-vs-corrector",
        promptEasy: "å¥¹è¯´ï¼šã€é»‘çœ¼åœˆæœ‰ç‚¹é‡ï¼Œæˆ‘è¦èƒ½æŠŠå®ƒé®ä½çš„é‚£æ”¯ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘è¿™é»‘çœ¼åœˆå¤ªæ˜æ˜¾äº†ï¼Œå¿«ç»™æˆ‘æ‹¿é‚£ä¸ªâ€œèƒ½ç›´æ¥ç›–ä½â€çš„ï¼Œä¸è¦æèŠ±é‡Œèƒ¡å“¨ã€‚ã€",
        a: { name: "é®ç‘•è†", img: ASSET_BASE + "concealer.webp", desc: "é®ç‘•è†ç”¨äºé®ç›–é»‘çœ¼åœˆã€ç—˜å°ç­‰å±€éƒ¨ç‘•ç–µï¼Œé€šå¸¸æ›´é«˜é®ç›–åŠ›ã€‚" },
        b: { name: "æ ¡è‰²è†", img: ASSET_BASE + "color-corrector.webp", desc: "æ ¡è‰²è†ç”¨äºä¸­å’Œè‚¤è‰²é—®é¢˜ï¼ˆæ³›çº¢/æš—æ²‰/é’ç´«ï¼‰ï¼Œæ›´åé¢œè‰²ä¿®æ­£è€Œéç›´æ¥é®ç›–ã€‚" },
        correct: "é®ç‘•è†"
      },
      {
        id: "blush-vs-contour",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³è„¸é¢Šçœ‹èµ·æ¥æœ‰ç‚¹è¡€è‰²ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘æƒ³çœ‹èµ·æ¥æ›´æœ‰ç²¾ç¥ä¸€ç‚¹ï¼Œä¸è¦åƒåˆšä¸‹ç­é‚£æ ·â€œè„¸ä¸€ç‰‡ç°â€ã€‚ã€",
        a: { name: "è…®çº¢", img: ASSET_BASE + "blush.webp", desc: "è…®çº¢ç”¨äºå¢åŠ çº¢æ¶¦æ°”è‰²ï¼Œé€šå¸¸ä¸Šåœ¨è‹¹æœè‚Œæˆ–é¢§éª¨é™„è¿‘ï¼Œç«‹åˆ»â€œæœ‰ç”Ÿå‘½åŠ›â€ã€‚" },
        b: { name: "ä¿®å®¹ï¼ˆé˜´å½±ï¼‰", img: ASSET_BASE + "contour.webp", desc: "ä¿®å®¹ç”¨äºåŠ å¼ºè½®å»“ä¸é˜´å½±ï¼Œåâ€œç˜¦è„¸/ç«‹ä½“â€ï¼Œä¸æ˜¯å¢åŠ æ°”è‰²çš„ä¸»åŠ›äº§å“ã€‚" },
        correct: "è…®çº¢"
      },
      {
        id: "highlighter-vs-glow-primer",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³é¼»æ¢ã€é¢§éª¨é‚£å„¿äº®ä¸€ç‚¹ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘æƒ³è„¸ä¸Šæœ‰ç‚¹â€œé—ªä¸€ä¸‹â€çš„æ„Ÿè§‰ï¼Œå°±é‚£ç§æ‹ç…§ä¸€è½¬å¤´ä¼šäº®çš„ã€‚ã€",
        a: { name: "é«˜å…‰", img: ASSET_BASE + "highlighter.webp", desc: "é«˜å…‰ç”¨äºå±€éƒ¨æäº®ï¼ˆé¢§éª¨/é¼»æ¢/çœ‰éª¨ç­‰ï¼‰ï¼Œå…‰æ³½é›†ä¸­ï¼Œé—ªåº¦æ›´æ˜æ˜¾ã€‚" },
        b: { name: "å¦†å‰ä¹³ï¼ˆç å…‰ï¼‰", img: ASSET_BASE + "glow-primer.webp", desc: "ç å…‰å¦†å‰ä¹³æ›´åæ•´ä½“æ‰“åº•æäº®ã€å¢åŠ æœå¸–åº¦ï¼Œå…‰æ³½æ›´å‡åŒ€æ›´å…‹åˆ¶ã€‚" },
        correct: "é«˜å…‰"
      },
      {
        id: "brow-pencil-vs-brow-powder",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³çœ‰æ¯›ç”»å¾—æ›´æ¸…æ¥šä¸€ç‚¹ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘æƒ³çœ‰æ¯›æ›´æœ‰æ„Ÿè§‰ï¼Œåˆ«ç³Šæˆä¸€ç‰‡ã€‚ã€",
        a: { name: "çœ‰ç¬”", img: ASSET_BASE + "brow-pencil.webp", desc: "çœ‰ç¬”çº¿æ¡æ„Ÿæ›´å¼ºï¼Œé€‚åˆåˆ»ç”»çœ‰å½¢ä¸ç»†èŠ‚ï¼Œå®¹æ˜“åšå‡ºæ¸…æ™°çœ‰å°¾å’Œæ¯›æµã€‚" },
        b: { name: "çœ‰ç²‰", img: ASSET_BASE + "brow-powder.webp", desc: "çœ‰ç²‰é›¾é¢æŸ”å’Œï¼Œé€‚åˆå¤§é¢ç§¯å¡«è‰²ä¸è‡ªç„¶è¿‡æ¸¡ï¼Œä½†çº¿æ¡é”åˆ©åº¦é€šå¸¸ä¸å¦‚çœ‰ç¬”ã€‚" },
        correct: "çœ‰ç¬”"
      },
      {
        id: "eyeliner-pen-vs-eyeliner-gel",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³è¦æ›´ä¸å®¹æ˜“æ™•çš„çœ¼çº¿ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘çœ¼çº¿è€æ˜¯ç³Šï¼ç»™æˆ‘æ‹¿é‚£ä¸ªæ›´æ‰›é€ çš„ï¼Œæˆ‘è¦ä»Šå¤©ä¸€æ•´å¤©éƒ½åˆ«å¡Œã€‚ã€",
        a: { name: "çœ¼çº¿æ¶²ç¬”", img: ASSET_BASE + "eyeliner-pen.webp", desc: "çœ¼çº¿æ¶²ç¬”å‡ºçº¿åˆ©è½ã€é”‹åˆ©ï¼Œé€‚åˆæ‹‰é•¿çœ¼å°¾ï¼Œä½†ä¸åŒé…æ–¹é˜²æ™•èƒ½åŠ›å·®å¼‚å¤§ã€‚" },
        b: { name: "çœ¼çº¿èƒ¶ç¬”", img: ASSET_BASE + "eyeliner-gel.webp", desc: "çœ¼çº¿èƒ¶ç¬”æ›´è´´åˆç«æ¯›æ ¹éƒ¨ï¼Œå¾ˆå¤šäººç”¨äºå†…çœ¼çº¿ä¸æ›´è€ç£¨çš„çº¿æ¡éœ€æ±‚ã€‚" },
        correct: "çœ¼çº¿èƒ¶ç¬”"
      },
      {
        id: "setting-spray-vs-setting-powder",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³é©¬ä¸Šæ§æ²¹ã€ä¸è¦åå…‰ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘ç°åœ¨è„¸å¥½æ²¹ï¼Œæˆ‘æƒ³è®©è„¸æ›´è‡ªç„¶ä¸€ç‚¹ï¼ã€",
        a: { name: "å®šå¦†å–·é›¾", img: ASSET_BASE + "setting-spray.webp", desc: "å®šå¦†å–·é›¾æ›´åæˆè†œä¸æœå¸–åº¦æå‡ï¼Œæ§æ²¹ä¸å“‘å…‰æ•ˆæœå–å†³äºé…æ–¹ç±»å‹ã€‚" },
        b: { name: "å®šå¦†ç²‰", img: ASSET_BASE + "setting-powder.webp", desc: "å®šå¦†ç²‰èƒ½æ›´ç›´æ¥å‹æ²¹å…‰ã€æŸ”ç„¦æ¯›å­”ï¼Œè¾¾åˆ°å¿«é€Ÿå“‘å…‰ä¸æ§æ²¹ç›®çš„ã€‚" },
        correct: "å®šå¦†ç²‰"
      },
      {
        id: "mascara-vs-lash-primer",
        promptEasy: "å¥¹è¯´ï¼šã€æˆ‘æƒ³ç«æ¯›åˆ·å®Œæ›´é•¿æ›´æµ“ã€‚ã€ä½ é€‰ï¼Ÿ",
        promptHard: "å¥¹è¯´ï¼šã€æˆ‘æƒ³çœ¼ç›ç«‹åˆ»æœ‰ç¥ï¼é‚£ç§ä¸€åˆ·å°±â€œçœ¼ç¥èµ·æ¥äº†â€çš„æ‹¿æ¥ã€‚ã€",
        a: { name: "ç«æ¯›è†", img: ASSET_BASE + "mascara.webp", desc: "ç«æ¯›è†ä¸»æ‰“çº¤é•¿/æµ“å¯†/å·ç¿˜ï¼Œèƒ½ç›´æ¥å¸¦æ¥æ˜æ˜¾å¦†æ•ˆå˜åŒ–ã€‚" },
        b: { name: "ç«æ¯›æ‰“åº•", img: ASSET_BASE + "lash-primer.webp", desc: "ç«æ¯›æ‰“åº•ç”¨äºå¢å¼ºåç»­ç«æ¯›è†è¡¨ç°ï¼Œæœ¬èº«å¦†æ•ˆé€šå¸¸æ›´å¼±ã€æ›´åè¾…åŠ©ã€‚" },
        correct: "ç«æ¯›è†"
      }
    ];

    function shuffle(arr) {
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }
    function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }
    function preloadImages(urls) { urls.forEach(u => { const im = new Image(); im.src = u; }); }

    // =============================
    // æœ¬åœ°â€œæœ€è¿‘ç§¯åˆ†â€
    // =============================
    const HISTORY_KEY = "gs_luobo_zhijin_couple_history_v1";
    function loadHistory() { try { return JSON.parse(localStorage.getItem(HISTORY_KEY) || "[]"); } catch { return []; } }
    function saveHistory(list) { localStorage.setItem(HISTORY_KEY, JSON.stringify(list)); }
    function pushHistory(entry) { const list = loadHistory(); list.unshift(entry); saveHistory(list.slice(0, 5)); }

    // =============================
    // è§†å›¾åˆ‡æ¢
    // =============================
    const viewHome   = document.getElementById("viewHome");
    const viewRules  = document.getElementById("viewRules");
    const viewScore  = document.getElementById("viewScore");
    const viewGame   = document.getElementById("viewGame");
    const viewResult = document.getElementById("viewResult");

    function showOnly(view) {
      [viewHome, viewRules, viewScore, viewGame, viewResult].forEach(v => v.classList.add("hidden"));
      view.classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // =============================
    // DOMï¼šéš¾åº¦ UI + æ¨¡å¼åˆ‡æ¢
    // =============================
    const btnDiffEasy = document.getElementById("btnDiffEasy");
    const btnDiffHard = document.getElementById("btnDiffHard");
    const diffHint = document.getElementById("diffHint");

    function applyOptionMode(diff) {
      const showEasy = diff === "easy";
      document.querySelectorAll("[data-mode='easy']").forEach(el => el.classList.toggle("hidden", !showEasy));
      document.querySelectorAll("[data-mode='hard']").forEach(el => el.classList.toggle("hidden", showEasy));
    }

    function renderDiffUI() {
      const d = getDiff();
      if (d === "easy") {
        btnDiffEasy.classList.add("bg-warmA");
        btnDiffHard.classList.remove("bg-warmA");
        diffHint.textContent = "æ™®é€šï¼šé€‰é¡¹åªç»™æ–‡å­—ã€‚çƒ­èº«å±€ï¼Œå»ºè®®å…ˆä»è¿™å¼€å§‹ã€‚";
      } else {
        btnDiffHard.classList.add("bg-warmA");
        btnDiffEasy.classList.remove("bg-warmA");
        diffHint.textContent = "å›°éš¾ï¼šé€‰é¡¹åªç»™å›¾ç‰‡ã€‚åˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³ã€‚";
      }
      applyOptionMode(d);
    }

    // =============================
    // DOMï¼šæ¸¸æˆ
    // =============================
    const roundNum = document.getElementById("roundNum");
    const scoreBadge = document.getElementById("scoreBadge");
    const promptEl = document.getElementById("prompt");

    const optA = document.getElementById("optA");
    const optB = document.getElementById("optB");

    const optATitle = document.getElementById("optATitle");
    const optBTitle = document.getElementById("optBTitle");

    const imgA = document.getElementById("imgA");
    const imgB = document.getElementById("imgB");

    const srNameA = document.getElementById("srNameA");
    const srNameB = document.getElementById("srNameB");

    const feedbackCard = document.getElementById("feedbackCard");
    const feedback = document.getElementById("feedback");
    const rewardLine = document.getElementById("rewardLine");
    const btnNext = document.getElementById("btnNext");

    // =============================
    // DOMï¼šç»“ç®—
    // =============================
    const heartsEl = document.getElementById("hearts");
    const finalScoreEl = document.getElementById("finalScore");
    const finalScoreInline = document.getElementById("finalScoreInline");
    const finalCommentEl = document.getElementById("finalComment");

    // =============================
    // DOMï¼šæœ€è¿‘ç§¯åˆ†
    // =============================
    const historyList = document.getElementById("historyList");
    const historyEmpty = document.getElementById("historyEmpty");

    // =============================
    // çŠ¶æ€
    // =============================
    let gameActive = false;
    let roundIndex = 0;
    let score = 0;
    let questions = [];
    let answered = false;
    let currentLayout = null; // {A:{name,img,desc}, B:{name,img,desc}, correctName}

    // =============================
    // è§£æèŠ‚ç‚¹ï¼šåŠ¨æ€æ’å…¥/ç§»é™¤
    // =============================
    function clearAnalysisNodes() {
      const aNode = optA.querySelector("[data-analysis='A']");
      const bNode = optB.querySelector("[data-analysis='B']");
      if (aNode) aNode.remove();
      if (bNode) bNode.remove();
    }

    function injectAnalysis(side, name, desc) {
      const host = (side === "A") ? optA : optB;

      const wrap = document.createElement("div");
      wrap.setAttribute("data-analysis", side);
      wrap.className = "mt-4 rounded-xl border border-appleGray/60 bg-white/80 p-4";

      const title = document.createElement("div");
      title.className = "text-sm text-appleSub";
      title.textContent = "é¢˜ç›®è§£æï¼ˆåˆ«æ€¥ï¼Œå­¦ä¼šäº†ä¸‹æ¬¡å†è£…ï¼‰";

      const n = document.createElement("div");
      n.className = "mt-1 text-base font-semibold";
      n.textContent = name;

      const p = document.createElement("div");
      p.className = "mt-2 text-sm text-appleSub leading-relaxed";
      p.textContent = desc;

      wrap.appendChild(title);
      wrap.appendChild(n);
      wrap.appendChild(p);
      host.appendChild(wrap);
    }

    // =============================
    // UIï¼šè¾¹æ¡†é«˜äº®
    // =============================
    function setOptionBorder(state) {
      [optA, optB].forEach(btn => {
        btn.classList.remove("border-appleGreen","border-appleRed","ring-2","ring-appleGreen","ring-appleRed");
        btn.classList.add("border-appleGray/60");
      });

      if (state === "correctA") { optA.classList.remove("border-appleGray/60"); optA.classList.add("border-appleGreen","ring-2","ring-appleGreen"); }
      if (state === "correctB") { optB.classList.remove("border-appleGray/60"); optB.classList.add("border-appleGreen","ring-2","ring-appleGreen"); }
      if (state === "wrongA") { optA.classList.remove("border-appleGray/60"); optA.classList.add("border-appleRed","ring-2","ring-appleRed"); }
      if (state === "wrongB") { optB.classList.remove("border-appleGray/60"); optB.classList.add("border-appleRed","ring-2","ring-appleRed"); }
    }

    function setChoicesEnabled(enabled) { optA.disabled = !enabled; optB.disabled = !enabled; }
    function updateHUD() { roundNum.textContent = String(roundIndex + 1); scoreBadge.textContent = String(score); }

    // =============================
    // æ¸¸æˆï¼šå¼€å§‹/å‡ºé¢˜/ä½œç­”/ç»“ç®—
    // =============================
    function startGame() {
      questions = shuffle(PAIRS).slice(0, 3);
      roundIndex = 0;
      score = 0;
      answered = false;
      gameActive = true;

      feedbackCard.classList.add("hidden");
      rewardLine.textContent = "";
      setOptionBorder("neutral");
      clearAnalysisNodes();

      const d = getDiff();
      applyOptionMode(d);

      // åªåœ¨å›°éš¾æ¨¡å¼é¢„åŠ è½½å›¾ç‰‡
      if (d === "hard") {
        const urls = [];
        questions.forEach(q => urls.push(q.a.img, q.b.img));
        preloadImages(urls);
      }

      showOnly(viewGame);
      loadRound();
    }

    function loadRound() {
      const q = questions[roundIndex];
      answered = false;
      updateHUD();

      const d = getDiff();
      promptEl.textContent = (d === "hard") ? q.promptHard : q.promptEasy;

      // æ´—ç‰Œæ‘†æ”¾ A/Bï¼ˆä½œç­”å‰ï¼šæ™®é€šä»…æ–‡å­—ï¼›å›°éš¾ä»…å›¾ç‰‡ï¼‰
      const variants = shuffle([
        { name: q.a.name, img: q.a.img, desc: q.a.desc },
        { name: q.b.name, img: q.b.img, desc: q.b.desc }
      ]);

      currentLayout = {
        A: variants[0],
        B: variants[1],
        correctName: q.correct
      };

      // æ™®é€šï¼šæ–‡å­—
      optATitle.textContent = currentLayout.A.name;
      optBTitle.textContent = currentLayout.B.name;

      // å›°éš¾ï¼šå›¾ç‰‡
      imgA.src = currentLayout.A.img;
      imgB.src = currentLayout.B.img;
      srNameA.textContent = currentLayout.A.name; // è¯»å±ç”¨
      srNameB.textContent = currentLayout.B.name;

      // åˆ‡é¢˜å‰ç§»é™¤ä¸Šä¸€é¢˜è§£æ
      clearAnalysisNodes();

      feedbackCard.classList.add("hidden");
      btnNext.disabled = true;
      setChoicesEnabled(true);
      setOptionBorder("neutral");
    }

    function answer(choiceKey) {
      if (!gameActive || answered) return;
      answered = true;

      setChoicesEnabled(false);

      const chosenName = currentLayout[choiceKey].name;
      const correctName = currentLayout.correctName;
      const isCorrect = chosenName === correctName;

      // ä½œç­”åï¼šæ’å…¥è§£æï¼ˆä¸“ä¸šè¡¨è¿°åªå‡ºç°åœ¨è¿™é‡Œï¼‰
      clearAnalysisNodes();
      injectAnalysis("A", currentLayout.A.name, currentLayout.A.desc);
      injectAnalysis("B", currentLayout.B.name, currentLayout.B.desc);

      feedbackCard.classList.remove("hidden");

      if (isCorrect) {
        score += 1;
        feedback.textContent = `ç­”å¯¹äº†ï¼šå¥¹è¦çš„æ˜¯ã€Œ${correctName}ã€ã€‚`;
        rewardLine.textContent = "ğŸ’‹ğŸ’‹ğŸ’‹ï¼ˆä»Šæ—¥ä¿å‘½æˆåŠŸï¼‰";
        setOptionBorder(choiceKey === "A" ? "correctA" : "correctB");
      } else {
        feedback.textContent = `ç­”é”™äº†ï¼šå¥¹è¦çš„æ˜¯ã€Œ${correctName}ã€ï¼Œä½ ç»™äº†ã€Œ${chosenName}ã€ã€‚`;
        rewardLine.textContent = "ğŸˆğŸˆğŸˆï¼ˆæ¦´è²æ¥å’¯ï¼‰";
        setOptionBorder(choiceKey === "A" ? "wrongA" : "wrongB");

        const correctKey = (currentLayout.A.name === correctName) ? "A" : "B";
        setTimeout(() => setOptionBorder(correctKey === "A" ? "correctA" : "correctB"), 250);
      }

      updateHUD();
      btnNext.textContent = (roundIndex === 2) ? "æŸ¥çœ‹ç»“ç®—ç»“æœ" : "ä¸‹ä¸€é¢˜";
      btnNext.disabled = false;
    }

    function nextStep() {
      if (!answered) return;
      if (roundIndex === 2) { endGame(); return; }
      roundIndex += 1;
      loadRound();
    }

    function endGame() {
      gameActive = false;

      pushHistory({ ts: Date.now(), score, total: 3, diff: getDiff() });
      renderResult();
      showOnly(viewResult);
    }

    function renderResult() {
      const s = clamp(score, 0, 3);
      const hearts = s === 0 ? "ğŸ’”" : "â¤ï¸".repeat(s);

      heartsEl.textContent = hearts;
      finalScoreInline.textContent = String(s);
      finalScoreEl.textContent = `${s} / 3`;

      let comment = "å…ˆåˆ«æ€¥ç€è‡ªä¿¡ï¼šå»ºè®®æŠŠå¥¹å¸¸ç”¨é‚£å‡ æ ·è®°ä¸‹æ¥ã€‚";
      if (s === 1) comment = "å‹‰å¼ºè¿‡å…³ï¼šæ¦´è²æš‚ç¼“å‘è´§ã€‚";
      if (s === 2) comment = "ä¸é”™ï¼šå·²ç»æœ‰ç‚¹â€œä¼šçœ‹çœ¼è‰²â€äº†ã€‚";
      if (s === 3) comment = "æ»¡åˆ†ï¼šä»Šæ™šä½ æ˜¯â€œæ»¡åˆ†ç”·å‹â€ã€‚";
      finalCommentEl.textContent = comment;
    }

    // =============================
    // æœ€è¿‘ç§¯åˆ†ï¼šæ¸²æŸ“
    // =============================
    function formatTime(ts) {
      const d = new Date(ts);
      const pad = (n) => String(n).padStart(2, "0");
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
    }

    function renderHistory() {
      const list = loadHistory();
      historyList.innerHTML = "";

      if (!list.length) {
        historyEmpty.classList.remove("hidden");
        return;
      }
      historyEmpty.classList.add("hidden");

      list.forEach(item => {
        const s = clamp(item.score, 0, 3);
        const hearts = s === 0 ? "ğŸ’”" : "â¤ï¸".repeat(s);
        const diffText = item.diff === "easy" ? "æ™®é€šæ¨¡å¼" : "å›°éš¾æ¨¡å¼";

        const card = document.createElement("div");
        card.className = "rounded-xl border border-appleGray/60 bg-white/80 p-4";
        card.innerHTML = `
          <div class="flex items-center justify-between gap-3">
            <div>
              <div class="text-sm text-appleSub">æ—¶é—´</div>
              <div class="mt-1 font-medium">${formatTime(item.ts)}</div>
              <div class="mt-1 text-sm text-appleSub">éš¾åº¦ï¼š${diffText}</div>
            </div>
            <div class="text-right">
              <div class="text-sm text-appleSub">æˆç»©</div>
              <div class="mt-1 text-lg font-semibold">${s}/3</div>
            </div>
          </div>
          <div class="mt-2 text-2xl">${hearts}</div>
        `;
        historyList.appendChild(card);
      });
    }

    // =============================
    // äº‹ä»¶ç»‘å®š
    // =============================
    document.getElementById("year").textContent = new Date().getFullYear();

    btnDiffEasy.addEventListener("click", () => setDiff("easy"));
    btnDiffHard.addEventListener("click", () => setDiff("hard"));

    document.getElementById("btnGoGame").addEventListener("click", startGame);
    document.getElementById("btnGoRules").addEventListener("click", () => showOnly(viewRules));
    document.getElementById("btnGoScore").addEventListener("click", () => { renderHistory(); showOnly(viewScore); });

    document.getElementById("btnRulesBack").addEventListener("click", () => showOnly(viewHome));

    document.getElementById("btnScoreBack").addEventListener("click", () => showOnly(viewHome));
    document.getElementById("btnClearHistory").addEventListener("click", () => {
      localStorage.removeItem(HISTORY_KEY);
      renderHistory();
    });

    optA.addEventListener("click", () => answer("A"));
    optB.addEventListener("click", () => answer("B"));
    btnNext.addEventListener("click", nextStep);
    document.getElementById("btnQuitToHome").addEventListener("click", () => showOnly(viewHome));

    document.getElementById("btnPlayAgain").addEventListener("click", startGame);
    document.getElementById("btnResultToHome").addEventListener("click", () => showOnly(viewHome));
    document.getElementById("btnResultToScore").addEventListener("click", () => { renderHistory(); showOnly(viewScore); });

    // åˆå§‹ï¼šæ¸²æŸ“éš¾åº¦ + é¦–é¡µ + emojiå¢™çº¸
    renderDiffUI();
    showOnly(viewHome);
    renderEmojiWall();

    window.addEventListener("resize", () => {
      clearTimeout(window.__emojiT);
      window.__emojiT = setTimeout(renderEmojiWall, 150);
    });
  </script>
</body>
</html>
